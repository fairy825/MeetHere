<!-- 模仿天猫整站springboot 教程 为how2j.cn 版权所有-->
<!-- 本教程仅用于学习使用，切勿用于非法用途，由此引起一切后果与本站无关-->
<!-- 供购买者学习，请勿私自传播，否则自行承担相关法律责任-->

<div th:fragment="html"> 
	<script>
		$(function(){
			var bid = getUrlParms("bid");
			var total = getUrlParms("total");
	        var data4Vue = {
	        		bid:'',
	        		total:'',
				msg:''
	        };
	        //ViewModel
	        var vue = new Vue({
	            el: '#workingArea',
	            data: data4Vue,
	            mounted:function(){ //mounted　表示这个 Vue 对象加载成功了
	            	this.bid = bid;
	            	this.total = total;
	            },
				methods: {

					payed: function () {
						var url = "payed/" + bid;
						axios.put(url).then(function (response) {
							console.log(response.data.data);

							if (response.data.status == 200) {
								vue.msg = "支付成功！"
								console.log(this.msg);
								$("#myModal").modal('show');
								setTimeout(function () {
									location.href = "bought";
								}, 2000);
								// $("#myModal").modal('show');
								// location.href = "bought";
							}else{
								vue.msg = response.data.msg;
								console.log(this.msg);
							}
						});
					}
				}
				});
		})		
	</script>
	<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<button data-dismiss="modal" class="close" type="button"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button>
					<h4 class="modal-title">{{msg}}</h4>
				</div>
			</div><!-- /.modal-content -->
		</div><!-- /.modal-dialog -->
	</div>
	<div class="aliPayPageDiv">
		<div>
			<span class="confirmMoneyText">扫一扫付款（元）</span>
			<span class="confirmMoney">
			￥ {{total|formatMoneyFilter}} </span>
			
		</div>
		<div>
			<img class="aliPayImg" src="img/site/alipay2wei.png">
		</div>
	
		<div>
			<button class="confirmPay" @click="payed">确认支付</button>
		</div>
	</div>

</div>
